<!DOCTYPE html>
<html lang="ru" style="--tg-viewport-height: 100vh; --tg-viewport-stable-height: 100vh;"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polo Ralph Lauren | Классика стиля</title>
    <link rel="stylesheet" href="tema.css">
</head>
<body>
<header>
    <div class="container">
        <h1>POLO RALPH LAUREN</h1>
        <p>Классика американского стиля</p>
    </div>
</header>

<div class="container" id="main-content">
    <div class="content">
        <div class="brand-info">
            <h2>О бренде</h2>
            <p>Polo Ralph Lauren — это символ элегантности, роскоши и неподвластного времени стиля. Основанный в 1967 году, бренд стал олицетворением американской мечты, сочетая в себе традиции и современность.</p>
            <p>Фирменные поло с лошадкой и игроком в поло узнаваемы во всём мире. Каждая вещь от Ralph Lauren — это качественные материалы, безупречный крой и внимание к деталям.</p>
            <p>Выберите свою классику.</p>
        </div>

        <div class="brand-image">
            <img src="https://media-assets.grailed.com/prd/listing/45714721/a082f185b58d43d3a92f83f597c2b441">
        </div>
    </div>

    <!-- Кнопка "Купить" -->
    <button class="buy-button" id="buyButton">Купить</button>
</div>

<!-- Форма заказа (изначально скрыта) -->
<div class="container">
    <form id="order-form">
        <h2>Оформление заказа</h2>
        <input type="text" placeholder="Ваше имя" id="user_name" required="">
        <input type="email" placeholder="Email" id="user_email" required="">
        <input type="tel" placeholder="Телефон" id="user_phone" required="">
        <div id="error"></div>
        <button type="button" id="orderButton">Отправить заказ</button>
    </form>
</div>

<footer>
    <div class="container">
        <p>© 2024 Polo Ralph Lauren. Все права защищены.</p>
    </div>
</footer>

<script src="https://telegram.org/js/telegram-web-app.js?58"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tg = window.Telegram.WebApp;
        const buyButton = document.getElementById("buyButton");
        const orderButton = document.getElementById("orderButton");
        const orderForm = document.getElementById("order-form");
        const mainContent = document.getElementById("main-content");
        const footer = document.querySelector('footer');
        const errorDiv = document.getElementById("error");

        // Инициализация WebApp
        tg.expand();
        tg.enableClosingConfirmation();
        tg.MainButton.hide();

        // Проверяем, что WebApp инициализирован
        if (!tg.initDataUnsafe) {
            console.error('Telegram WebApp not initialized properly');
            errorDiv.textContent = 'Ошибка инициализации приложения. Пожалуйста, откройте через Telegram.';
            return;
        }

        buyButton.addEventListener("click", () => {
            mainContent.classList.add('hidden');
            footer.classList.add('hidden');
            orderForm.style.display = "block";

            // Заполняем имя пользователя Telegram
            const user = tg.initDataUnsafe.user || {};
            const name = [user.first_name, user.last_name].filter(Boolean).join(' ');
            if (name) document.getElementById("user_name").value = name;
        });

        orderButton.addEventListener("click", () => {
            // Получаем данные формы
            const tg = window.Telegram.WebApp;

            const formData = {
                name: document.getElementById("user_name").value.trim(),
                email: document.getElementById("user_email").value.trim(),
                phone: document.getElementById("user_phone").value.trim()
            };

            // Валидация
            if (!formData.name || formData.name.length < 2) {
                errorDiv.textContent = 'Имя должно содержать минимум 2 символа';
                return;
            }
            if (!formData.email.includes('@') || !formData.email.includes('.')) {
                errorDiv.textContent = 'Введите корректный email';
                return;
            }
            if (!formData.phone || formData.phone.length < 5) {
                errorDiv.textContent = 'Номер телефона должен содержать минимум 5 символов';
                return;
            }
            

            // Отправляем данные в Telegram
            console.log("Отправляем данные:", formData);
            tg.sendData(JSON.stringify(formData));

            // Показываем подтверждение
            tg.showAlert('Спасибо за заказ! Мы скоро с вами свяжемся.', () => {
                tg.close();
            });
        });
    });
</script>

</body></html>
